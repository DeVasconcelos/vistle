MACRO(USE_MPI)
  FIND_PACKAGE(MPI)
  IF ((NOT MPI_FOUND) AND (${ARGC} LESS 1))
    MESSAGE("Skipping because of missing MPI")
    RETURN()
  ENDIF((NOT MPI_FOUND) AND (${ARGC} LESS 1))
  IF(NOT MPI_USED AND MPI_FOUND)
    SET(MPI_USED TRUE)
    ADD_DEFINITIONS(-DHAS_MPI)
    INCLUDE_DIRECTORIES(${MPI_INCLUDE_PATH})
    SET(EXTRA_LIBS ${EXTRA_LIBS} ${MPI_LIBRARIES})
  ENDIF()
ENDMACRO(USE_MPI)

